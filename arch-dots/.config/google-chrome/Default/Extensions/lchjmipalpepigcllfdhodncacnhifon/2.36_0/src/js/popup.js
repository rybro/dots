var cfg=JSON.parse(localStorage["ChromeLL-Config"]),ignoratorData={};function openBookmark(a){window.open("http://boards.endoftheinter.net/topics/"+document.savedtags.bookmark.value)}function openControl(a){window.open("http://endoftheinter.net/tag.php?tag="+document.tagcontrol.tag.value)}function openOptions(){chrome.runtime.sendMessage({need:"options"});window.close()}
function showHidden(a,b){console.log(ignoratorData.users[a].trs);chrome.runtime.sendMessage({need:"showIgnorated",ids:ignoratorData.users[a].trs});b.parentNode.style.display="none"}
function populateMenus(){var a=cfg.saved_tags,b=cfg.bookmark_data,k=cfg.tag_admin,d=document.getElementById("bookmarks"),e=document.getElementById("tags"),f;for(f in a){var g=f,h=a[f],c=document.createElement("option");c.textContent=g;c.value=h;d.appendChild(c)}for(f in b)g=f,h=b[f],c=document.createElement("option"),c.textContent=g,c.value=h,d.appendChild(c);a=0;for(b=k.length;a<b;a++)g=k[a],c=document.createElement("option"),c.textContent=g,e.appendChild(c)}
function addListeners(){document.getElementById("worksafe").addEventListener("change",function(a){a.path[0].checked?(cfg.hide_nws_gfycat=!0,localStorage["ChromeLL-Config"]=JSON.stringify(cfg)):a.path[0].checked||(cfg.hide_nws_gfycat=!1,localStorage["ChromeLL-Config"]=JSON.stringify(cfg))});document.getElementById("bookmarks").addEventListener("change",openBookmark);document.getElementById("tags").addEventListener("change",openControl);document.getElementById("options").addEventListener("click",openOptions)}
function handleIgnorator(){var a;(cfg.ignorator&&cfg.ignorator_list||!cfg.ignorator&&cfg.ignore_keyword&&cfg.ignore_keyword_list)&&chrome.runtime.sendMessage({need:"noIgnores"},function(b){b.noIgnores||chrome.runtime.sendMessage({need:"getIgnored"},function(b){ignoratorData=b.ignorator.data;if(b.ignorator.data.users)for(var d in b.ignorator.data.users){a=document.createElement("div");a.className="user_ignore";var e=document.createElement("span");e.title="show "+d+" on this page";e.className="show_hidden";
e.innerHTML="x";e.addEventListener("click",function(a){showHidden(a.target.parentNode.getElementsByClassName("i_data")[0].innerHTML,a.target)});a.innerHTML='<span class="rm_num">'+b.ignorator.data.users[d].total+'</span><span class="i_data">'+d+"</span>";a.insertBefore(e,null);document.getElementById("js_insert").insertBefore(a,null)}if(b.ignorator.data.keywords)for(d in b.ignorator.data.keywords)a=document.createElement("div"),a.className="keyword_ignore",a.innerHTML='<span class="rm_num">'+b.ignorator.data.keywords[d].total+
"</span>"+d,document.getElementById("js_insert").insertBefore(a,null)})})}document.addEventListener("DOMContentLoaded",function(){var a=document.getElementById("worksafe"),b=document.getElementById("a_msg_history");cfg.hide_nws_gfycat?a.checked=!0:a.checked=!1;cfg.sort_history&&(b.href="http://boards.endoftheinter.net/history.php?b");populateMenus();handleIgnorator();addListeners()});
